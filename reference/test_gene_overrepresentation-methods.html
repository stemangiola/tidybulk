<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>analyse gene over-representation with GSEA — test_gene_overrepresentation • tidybulk</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="analyse gene over-representation with GSEA — test_gene_overrepresentation"><meta property="og:description" content="test_gene_overrepresentation() takes as input a `tbl` (with at least three columns for sample, feature and transcript abundance) or `SummarizedExperiment` (more convenient if abstracted to tibble with library(tidySummarizedExperiment)) and returns a `tbl` with the GSEA statistics"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidybulk</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.6.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/comparison_with_base_R.html">Comparison with base R</a>
    </li>
    <li>
      <a href="../articles/introduction.html">Overview of the tidybulk package</a>
    </li>
    <li>
      <a href="../articles/manuscript_differential_transcript_abundance.html">Manuscript code - differential feature abundance</a>
    </li>
    <li>
      <a href="../articles/manuscript_transcriptional_signatures.html">Manuscript code - transcriptional signature identification</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/stemangiola/tidybulk/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>analyse gene over-representation with GSEA</h1>
    <small class="dont-index">Source: <a href="https://github.com/stemangiola/tidybulk/blob/HEAD/R/methods.R" class="external-link"><code>R/methods.R</code></a>, <a href="https://github.com/stemangiola/tidybulk/blob/HEAD/R/methods_SE.R" class="external-link"><code>R/methods_SE.R</code></a></small>
    <div class="hidden name"><code>test_gene_overrepresentation-methods.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>test_gene_overrepresentation() takes as input a `tbl` (with at least three columns for sample, feature and transcript abundance) or `SummarizedExperiment` (more convenient if abstracted to tibble with library(tidySummarizedExperiment)) and returns a `tbl` with the GSEA statistics</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">test_gene_overrepresentation</span><span class="op">(</span>
  <span class="va">.data</span>,
  <span class="va">.entrez</span>,
  <span class="va">.do_test</span>,
  <span class="va">species</span>,
  .sample <span class="op">=</span> <span class="cn">NULL</span>,
  gene_sets <span class="op">=</span> <span class="cn">NULL</span>,
  gene_set <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span>

<span class="co"># S4 method for spec_tbl_df</span>
<span class="fu">test_gene_overrepresentation</span><span class="op">(</span>
  <span class="va">.data</span>,
  <span class="va">.entrez</span>,
  <span class="va">.do_test</span>,
  <span class="va">species</span>,
  .sample <span class="op">=</span> <span class="cn">NULL</span>,
  gene_sets <span class="op">=</span> <span class="cn">NULL</span>,
  gene_set <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span>

<span class="co"># S4 method for tbl_df</span>
<span class="fu">test_gene_overrepresentation</span><span class="op">(</span>
  <span class="va">.data</span>,
  <span class="va">.entrez</span>,
  <span class="va">.do_test</span>,
  <span class="va">species</span>,
  .sample <span class="op">=</span> <span class="cn">NULL</span>,
  gene_sets <span class="op">=</span> <span class="cn">NULL</span>,
  gene_set <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span>

<span class="co"># S4 method for tidybulk</span>
<span class="fu">test_gene_overrepresentation</span><span class="op">(</span>
  <span class="va">.data</span>,
  <span class="va">.entrez</span>,
  <span class="va">.do_test</span>,
  <span class="va">species</span>,
  .sample <span class="op">=</span> <span class="cn">NULL</span>,
  gene_sets <span class="op">=</span> <span class="cn">NULL</span>,
  gene_set <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span>

<span class="co"># S4 method for SummarizedExperiment</span>
<span class="fu">test_gene_overrepresentation</span><span class="op">(</span>
  <span class="va">.data</span>,
  <span class="va">.entrez</span>,
  <span class="va">.do_test</span>,
  <span class="va">species</span>,
  .sample <span class="op">=</span> <span class="cn">NULL</span>,
  gene_sets <span class="op">=</span> <span class="cn">NULL</span>,
  gene_set <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span>

<span class="co"># S4 method for RangedSummarizedExperiment</span>
<span class="fu">test_gene_overrepresentation</span><span class="op">(</span>
  <span class="va">.data</span>,
  <span class="va">.entrez</span>,
  <span class="va">.do_test</span>,
  <span class="va">species</span>,
  .sample <span class="op">=</span> <span class="cn">NULL</span>,
  gene_sets <span class="op">=</span> <span class="cn">NULL</span>,
  gene_set <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>.data</dt>
<dd><p>A `tbl` (with at least three columns for sample, feature and transcript abundance) or `SummarizedExperiment` (more convenient if abstracted to tibble with library(tidySummarizedExperiment))</p></dd>
<dt>.entrez</dt>
<dd><p>The ENTREZ ID of the transcripts/genes</p></dd>
<dt>.do_test</dt>
<dd><p>A boolean column name symbol. It indicates the transcript to check</p></dd>
<dt>species</dt>
<dd><p>A character. For example, human or mouse. MSigDB uses the latin species names (e.g., \"Mus musculus\", \"Homo sapiens\")</p></dd>
<dt>.sample</dt>
<dd><p>The name of the sample column</p></dd>
<dt>gene_sets</dt>
<dd><p>A character vector. The subset of MSigDB datasets you want to test against (e.g. \"C2\"). If NULL all gene sets are used (suggested). This argument was added to avoid time overflow of the examples.</p></dd>
<dt>gene_set</dt>
<dd><p>DEPRECATED. Use gene_sets instead.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A consistent object (to the input)
A `spec_tbl_df` object
A `tbl_df` object
A `tidybulk` object
A `SummarizedExperiment` object
A `RangedSummarizedExperiment` object</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>`r lifecycle::badge("maturing")`</p>
<p>This wrapper execute gene enrichment analyses of the dataset using a list of transcripts and GSEA.
This wrapper uses clusterProfiler (DOI: doi.org/10.1089/omi.2011.0118) on the back-end.</p>
<p>Undelying method:
 msigdbr::msigdbr(species = species) <!-- %&gt;%#' -->
	nest(data = -gs_cat) <!-- %&gt;% -->
	mutate(test =
			map(
				data,
				~ clusterProfiler::enricher(
					my_entrez_rank,
				 	TERM2GENE=.x <!-- %&gt;% select(gs_name, entrez_gene), -->
					pvalueCutoff = 1
					) <!-- %&gt;%	as_tibble -->
			))</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="va">df_entrez</span> <span class="op">=</span> <span class="fu">tidybulk</span><span class="fu">::</span><span class="va"><a href="se_mini.html">se_mini</a></span> |&gt; <span class="fu"><a href="tidybulk-methods.html">tidybulk</a></span><span class="op">(</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> |&gt; <span class="fu"><a href="symbol_to_entrez.html">symbol_to_entrez</a></span><span class="op">(</span> .transcript <span class="op">=</span> <span class="va">feature</span>, .sample <span class="op">=</span> <span class="va">sample</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 'select()' returned 1:many mapping between keys and columns</span>
<span class="r-in"><span class="va">df_entrez</span> <span class="op">=</span> <span class="fu"><a href="aggregate_duplicates-methods.html">aggregate_duplicates</a></span><span class="op">(</span><span class="va">df_entrez</span>, aggregation_function <span class="op">=</span> <span class="va">sum</span>, .sample <span class="op">=</span> <span class="va">sample</span>, .transcript <span class="op">=</span> <span class="va">entrez</span>, .abundance <span class="op">=</span> <span class="va">count</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>tidybulk says: for aggregation, factors and logical columns were converted to character</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Converted to characters</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> factorfactorfactorfactorlogical</span>
<span class="r-in"><span class="va">df_entrez</span> <span class="op">=</span> <span class="fu"><a href="mutate-methods.html">mutate</a></span><span class="op">(</span><span class="va">df_entrez</span>, do_test <span class="op">=</span> <span class="va">feature</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TNFRSF4"</span>, <span class="st">"PLCH2"</span>, <span class="st">"PADI4"</span>, <span class="st">"PAX7"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">  <span class="fu">test_gene_overrepresentation</span><span class="op">(</span></span>
<span class="r-in">    <span class="va">df_entrez</span>,</span>
<span class="r-in">    .sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span class="r-in">    .entrez <span class="op">=</span> <span class="va">entrez</span>,</span>
<span class="r-in">    .do_test <span class="op">=</span> <span class="va">do_test</span>,</span>
<span class="r-in">    species<span class="op">=</span><span class="st">"Homo sapiens"</span>,</span>
<span class="r-in">   gene_sets <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C2"</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stefano Mangiola.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

